# Техническое Задание на разработку платформы проекта AI Office

Ниже описаны требования к платформе и основной функционал, который требуется реализовать (или развивать по мере приёма Pull Request’ов).

## 1. Архитектура проекта

### 1.1 Общая структура
- **Backend (Flask)**:  
  - Модуль логики агентов (OpenAI Agents SDK), работа с БД (SQLite/PostgreSQL).  
  - REST API / WebSocket API для фронтенда.  
- **Frontend (Vue 3 + TypeScript + Vite)**:  
  - Интерфейс просмотра эпизодов, голосований, предложений от пользователей.  
  - Панель управления (для Script Advisor и администратора).
- **Модуль анимации и озвучки** (отдельный pipeline или service):
  - Интеграция с Midjourney (генерация аватарок/фонов) или opensource решением.  
  - Sora/Kling для анимации.  
  - TTS + lip-sync (Wav2Lip) для голосов персонажей.  

### 1.2 Основные сущности и потоки данных

1. **Агенты**  
   - Имеют следующие данные: `id`, `name`, `role`, `skills`, `personality`, `reputation`, `status`, .  
   - Через Agents SDK могут вызывать Tools (например, «Поиск в интернете», «Чтение репозитория GitHub», «Запись в репозиторий»).

2. **Пользователи**  
   - `id`, `oauth_id`, `nickname`, `role` (admin, script_advisor, viewer).  
   - Доступ к функционалу зависит от роли.  
   - Могут предлагать идеи, голосовать, комментировать.

3. **Эпизоды**  
   - `id`, `title`, `status` (draft, published), `script` (финальный текст сценария).  
   - Ссылка на опубликованное видео (YouTube) или локальный плеер.

4. **Диалоги / логи агентов**  
   - Хранение в таблице: `agent_id`, `message`, `timestamp`.  
   - После каждой «итерации» (завершения задачи) формируется отдельный «пакет» (лог).

5. **Голосования**  
   - `vote_id`, `episode_id`, `options[]`, `results[]`, `deadline`.  
   - Пользователь может отдать голос, изменения фиксируются в БД.

## 2. Функциональные модули

### 2.1 Модуль логики агентов (Backend)

- **OpenAI Agents SDK**  
  - Определяем конфигурацию: описание персонажей, их целей и стилей поведения.  
  - Реализуем «оркестровку» итераций: кто инициирует задачу (CEO, после получения инструкий от живого Script Advisor), как агенты вызывают Tools, как завершается итерация.  
- **Tools**  
  - `search_internet(query)` — отправляет HTTP-запросы (или чтение контента) для анализа новостей, форумов и т.д.  
  - `git_interaction(action, data)` — чтение или запись кода в репозиторий (например, GitHub).  
  - `ask_script_advisor(question)` — запрос к человеческому редактору, если агенты застряли.  
- **Система памяти**  
  - Сохранять ключевые события (кто предложил идею, кто отказался и почему).  
  - Возможен простой вариант: записи в SQL-базу + контекст «диалога» при генерации новой реплики.
  - Векторная база, в которую можно добавлять сценарии после каждого сезона, это позволит офису помнить, что было раньше.

### 2.2 Модуль веб-платформы (Frontend + Backend)

- **Frontend (Vue 3)**  
  - **Экран эпизодов**: список эпизодов, просмотр конкретной серии (встроенный плеер YouTube или аналог).  
  - **Экран голосований**: выбор опции, просмотр результатов.  
  - **Экран комментариев**: пользователи обсуждают выпуски, предлагают идеи.  
  - **Админ-панель**: доступна Script Advisor и admin, чтобы смотреть черновики сценария, править их, «запускать» новую итерацию агентов.  
- **Backend (Flask)**  
  - **API для эпизодов**: `GET /episodes`, `GET /episodes/:id`, `POST /episodes` (админ только), и т. д.  
  - **API для голосований**: `GET /votes/:episode_id`, `POST /votes/:id`.  
  - **Авторизация**: поддержка OAuth (GitHub, Google и т. д.).  
  - **Сохранение/получение логов**: часть логов может быть доступна только админу или «премиум»-пользователям (зависит от концепта).

### 2.3 Модуль генерации сценария

- **Агент-сценарист**  
  - Получает итоги диалогов, выжимку конфликта/решения.  
  - Генерирует черновой «художественный» сценарий (делит на сцены, добавляет юмор, гиперболы).  
- **Агент-раскадровщик**
   - На основе сценария рисует раскадровки с описанием каждой сцены, включая локации, персонажей и ключевые действия с промптами.
- **Script Advisor (человек)**  
  - Веб-интерфейс для редактирования, комментирования сценария, утверждения финальной версии.  
  - Возможность «подсветки» фрагментов, которые нужно доработать (протестируем разные варианты UI).

### 2.4 Модуль анимации и озвучки

- **Pipeline**  
  1. Получаем текст сцен и реплики персонажей.  
  2. Генерируем (или выбираем) фоны/аватарки через Midjourney или аналог.  
  3. Запускаем Sora/Kling для анимирования (простые движения, раскадровка).  
  4. Синтезируем голос через TTS (Bark, Amazon Polly, Azure TTS — на выбор).  
  5. Прогоняем через Wav2Lip (или аналог) для синхронизации губ.  
  6. Склеиваем в единый ролик, добавляем фоновую музыку и звуковые эффекты.  
- **Вывод**: итоговый MP4-файл загружается на YouTube, ссылка сохраняется в нашем `episodes`-хранилище.

## 3. Механика интерации (шоу-цикл)

1. **Инициация**: Admin/Script Advisor нажимает «Start new iteration».  
2. **Агенты**: Получают задачу, общаются/спорят, вызывают Tools, делают кодовые коммиты. Лог сохраняется.  
3. **Завершение итерации**: Когда задача выполнена (или истёк лимит шагов):  
   - Система формирует «черновой» сценарий.  
   - Script Advisor проверяет и «вылизывает» финальный текст.  
   - Запускается анимация и озвучка.  
4. **Публикация эпизода**:  
   - Видео добавляется в список эпизодов.  
   - В конце серии — голосование/опрос.  
5. **Агенты читают результаты голосования** (в начале следующей итерации) и корректируют свои решения.

## 4. Дорожная карта (Roadmap)

1. **MVP (базовый прототип)**  
   - Простая конфигурация агентов (CEO, Backend Dev, Frontend Dev, один PM).  
   - Минимальная логика Tools (поиск в интернете, простые кодовые действия).  
   - Веб-платформа с авторизацией и просмотром эпизодов.  
2. **Этап 2**  
   - Добавить остальных агентов (CTO, дизайнер, маркетолог, HR и т. д.).  
   - Расширить логику фракций (конфликты, репутация).  
   - Улучшить UI голосований и отзывов.  
3. **Этап 3**  
   - Подключение полноценной анимации (Sora/Kling), синтеза речи.  
   - Автоматизация сборки короткого ролика.  
4. **Этап 4**  
   - Запуск 1-го полноценного «сезона» (8–10 серий).  
   - Активное участие сообщества в расширении кода и сценарной части.

## 5. Требования к окружению

- **Python 3.9+**, Flask, openai, requests, SQLAlchemy (или любая ORM).  
- **Vue 3 + Vite + TypeScript**, Axios для запросов.  
- **Docker** (опционально) — для удобства развертывания и изоляции.  
- **Сервисы** (опционально): Midjourney (через Discord bot), Sora/Kling (облачный/локальный), Wav2Lip (локальная модель или интеграция).

## 6. Как развернуть локально

1. **Склонировать репозиторий**  
   ```bash
   git clone https://github.com/yourname/ai-office.git
   cd ai-office
   ```
2. **Установить зависимости (Backend)**  
   ```bash
   pip install -r requirements.txt
   ```
3. **Настроить env-файл** (пример `.env`):  
   ```
   FLASK_ENV=development
   OPENAI_API_KEY=YOUR_OPENAI_KEY
   DATABASE_URL=sqlite:///db.sqlite3
   ```
4. **Запустить сервер**  
   ```bash
   flask run
   ```
5. **Установить зависимости (Frontend)**  
   ```bash
   cd frontend
   npm install
   npm run dev
   ```
6. **Открыть в браузере** [http://localhost:3000](http://localhost:3000) или любой порт, который показан в терминале.

---

Проект распространяется под лицензией [Creative Commons Attribution-NonCommercial-ShareAlike 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ru). Вы можете свободно использовать код, модифицировать его и вносить свой вклад. Просим сохранять упоминание авторов и соблюдать условия лицензии.